project requirements document;;;;;
Lume & Lore;;;;;
;;;;;
Requirement ID;Description;User Story;Expected Behavior / Outcome;;
M001;Book Ingestion;The user can search and download books from Project Gutenberg or select a local text file.;The GutenbergHarvester downloads raw text, strips legal headers/footers, and saves a clean version to data/books/.;;
M002;Engine Initialization;"The user can start the creation process by initializing the ""AI Director"" with a selected book.";"The AutonomousArchitect uploads the book to Gemini, creates a cached context, and injects a ""Master Director"" system instruction to ensure narrative style and consistency.";;
M003;Interactive Scene Generation;"The user can generate and edit narrative ""beats"" with branching paths (Golden, Exquisite, Bad).";The Architect produces a JSON structure containing a scene description and three distinct choices. The user can review and modify the text before it is finalized.;;
M004;Visual Asset Creation;The user can generate and refine images for each scene and reward outcome.;"The VisualWeaver sends prompts to a local Stable Diffusion API (WebUI Forge). It combines AI-generated scene prompts with ""Master Style"" modifiers to create high-fidelity PNG assets.";;
;;;1;;
M005;Project Configuration;The user can configure project metadata, AI model selection, and visual style parameters.;The Dashboard saves settings to book_config.json, including llm_model, Stable Diffusion parameters (steps, sampler, CFG scale), and global art style prompts.;;
M006;Ink Script Export;The user saves the approved narrative into a professional game-industry standard format.;The InkSmith translates scene data into valid .ink code, maintaining global variables (health, morale) and using tags (e.g., # IMAGE: filename) for visual integration.;;
M007;Asset Management;When a scene is approved, all associated text and images are organized into a project folder.;Images are saved to data/output/[book_id]/assets/, and the adventure script is updated in real-time.;;
M008;Narrative Continuity;"The engine must maintain a ""memory"" of the story's progress to avoid AI amnesia.";The ProgressManager saves checkpoints, and the Architect re-injects the current .ink state back into the LLM's context during subsequent generation steps.;;
P001;Ink Engine Integration;The player can load and play an adventure written in the Ink narrative language.;The application utilizes the inkjs library to parse and execute compiled story data in JSON format.;;
P002;Automatic Content Fetching;The user sees the story content immediately upon opening the player.;The player automatically fetches adventure.json and initializes the story state via an asynchronous process.;;
P003;Dynamic Narrative Rendering;The user can read the story text as it unfolds scene by scene.;The system loops through story.Continue() to render all text paragraphs for the current beat into the #story-text container.;;
P004;Interactive Choice Navigation;The user can influence the story's direction by selecting from various narrative options.;"Available choices are rendered as buttons; clicking a button advances the Ink engine and triggers a UI refresh to show the next part of the story.";;
P005;Tag-Driven Visuals;The user sees an image that changes to match the current scene's setting or outcome.;"The player monitors Ink ""tags"" (e.g., # IMAGE: filename) to dynamically update the source of the displayed image from the assets/ folder.";;
P006;Responsive Device Support;The user can play the game comfortably on both mobile devices and desktop screens.;The UI layout uses CSS media queries to switch between a stacked portrait view and a side-by-side landscape view based on device orientation.;;
P007;Literary UI Aesthetic;The user experiences a visually immersive environment that feels like a classic book.;The interface features high-contrast dark-mode colors and uses serif typography (Georgia) for a traditional literary feel.;;
P008;Game State Persistence;The user can close the browser and return later without losing their progress.;The application serializes the Ink story state to JSON and stores it in the browser's localStorage for session recovery.;;
P009;Audio Orchestration;The user hears ambient sounds or music that enhance the story's atmospheric mood.;A custom tag handler (e.g., # AMBIENCE: rain) triggers looped audio files managed by a central sound controller.;;
P010;Visual Transitions;The user experiences smooth visual shifts between different scenes or outcomes.;The player applies CSS cross-fades or animations to the image container whenever a new IMAGE: tag is detected.;;
P011;Narrative Pacing (Typewriter);"The user reads the text at a cinematic pace as it is ""typed"" out on the screen.";"A JavaScript-based typing effect animates the appearance of new text blocks, with a user option to ""skip"" the animation and show text instantly.";;
